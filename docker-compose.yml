networks:
  default:
    name: ${DOCKER_NETWORK_NAME}
services:
  ipa:
    environment:
      - IPA_SERVER_HOSTNAME
      - IPA_SERVER_IP
      - IPA_SERVER_INSTALL_OPTS
      - PASSWORD
      - TZ
    healthcheck:
      test: ["CMD", "/usr/bin/systemctl", "status", "ipa"]
      timeout: 10s
      interval: 10s
    hostname: ${IPA_SERVER_HOSTNAME}
    image: quay.io/freeipa/freeipa-server:${IPA_IMAGE_TAG}
    read_only: true
    stop_signal: RTMIN+3
    sysctls:
      net.ipv6.conf.all.disable_ipv6: 0
    tmpfs:
      - /run
      - /tmp
    volumes:
      - ipa_data:/data
      - ipa_journal:/var/log/journal
volumes:
  ipa_data:
  ipa_journal:
